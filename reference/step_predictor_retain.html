<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Supervised Feature Selection via A Single Filter — step_predictor_retain • important</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Supervised Feature Selection via A Single Filter — step_predictor_retain"><meta name="description" content="step_predictor_retain() creates a specification of a recipe step that
uses a logical statement that includes one or more scoring functions to
measure how much each predictor is related to the outcome value. This step
retains the predictors that pass the logical statement."><meta property="og:description" content="step_predictor_retain() creates a specification of a recipe step that
uses a logical statement that includes one or more scoring functions to
measure how much each predictor is related to the outcome value. This step
retains the predictors that pass the logical statement."><script defer data-domain="important.tidymodels.org,all.tidymodels.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">important</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidymodels/important/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Supervised Feature Selection via A Single Filter</h1>
      <small class="dont-index">Source: <a href="https://github.com/tidymodels/important/blob/main/R/step_predictor_retain.R" class="external-link"><code>R/step_predictor_retain.R</code></a></small>
      <div class="d-none name"><code>step_predictor_retain.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>step_predictor_retain()</code> creates a <em>specification</em> of a recipe step that
uses a logical statement that includes one or more scoring functions to
measure how much each predictor is related to the outcome value. This step
retains the predictors that pass the logical statement.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">step_predictor_retain</span><span class="op">(</span></span>
<span>  <span class="va">recipe</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  <span class="va">score</span>,</span>
<span>  role <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  trained <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  results <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  removals <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  skip <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/rand_id.html" class="external-link">rand_id</a></span><span class="op">(</span><span class="st">"predictor_retain"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-recipe">recipe<a class="anchor" aria-label="anchor" href="#arg-recipe"></a></dt>
<dd><p>A recipe object. The step will be added to the sequence of
operations for this recipe.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>One or more selector functions to choose variables for this step.
See <code><a href="https://recipes.tidymodels.org/reference/selections.html" class="external-link">selections()</a></code> for more details.</p></dd>


<dt id="arg-score">score<a class="anchor" aria-label="anchor" href="#arg-score"></a></dt>
<dd><p>A valid R expression that produces a logical result. The
equation can contain the names of one or more score functions from the
<span class="pkg">filtro</span> package, such as <code><a href="https://filtro.tidymodels.org/reference/score_imp_rf.html" class="external-link">filtro::score_imp_rf()</a></code>,
<code><a href="https://filtro.tidymodels.org/reference/score_roc_auc.html" class="external-link">filtro:: score_roc_auc()</a></code>. See the Details and Examples sections below.
This argument <em>should be named</em> when used.</p></dd>


<dt id="arg-role">role<a class="anchor" aria-label="anchor" href="#arg-role"></a></dt>
<dd><p>Not used by this step since no new variables are created.</p></dd>


<dt id="arg-trained">trained<a class="anchor" aria-label="anchor" href="#arg-trained"></a></dt>
<dd><p>A logical to indicate if the quantities for preprocessing have
been estimated.</p></dd>


<dt id="arg-results">results<a class="anchor" aria-label="anchor" href="#arg-results"></a></dt>
<dd><p>A data frame of score and desirability values for each
predictor evaluated. These values are not determined until <code><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">recipes::prep()</a></code>
is called.</p></dd>


<dt id="arg-removals">removals<a class="anchor" aria-label="anchor" href="#arg-removals"></a></dt>
<dd><p>A character string that contains the names of predictors that
should be removed. These values are not determined until <code><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">recipes::prep()</a></code>
is called.</p></dd>


<dt id="arg-skip">skip<a class="anchor" aria-label="anchor" href="#arg-skip"></a></dt>
<dd><p>A logical. Should the step be skipped when the recipe is baked by
<code><a href="https://recipes.tidymodels.org/reference/bake.html" class="external-link">bake()</a></code>? While all operations are baked when <code><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep()</a></code> is run, some
operations may not be able to be conducted on new data (e.g. processing the
outcome variable(s)). Care should be taken when using <code>skip = TRUE</code> as it
may affect the computations for subsequent operations.</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>A character string that is unique to this step to identify it.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An updated version of <code>recipe</code> with the new step added to the
sequence of any existing operations. When you
<code><a href="https://recipes.tidymodels.org/reference/tidy.recipe.html" class="external-link">tidy()</a></code> this step, a tibble::tibble is returned
with columns <code>terms</code> and <code>id</code>:</p>
<dl><dt>terms</dt>
<dd><p>character, the selectors or variables selected to be removed</p></dd>

<dt>id</dt>
<dd><p>character, id of this step</p></dd>


</dl><p>Once trained, additional columns are included (see Details section).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>score</code> should be valid R syntax that produces a logical result and
should not use external data. The list of variables that can be used is in
the section below.</p><div class="section">
<h3 id="scoring-functions">Scoring Functions<a class="anchor" aria-label="anchor" href="#scoring-functions"></a></h3>


<p>As of version 0.2.0 of the <span class="pkg">filtro</span> package, the following score functions are available:</p>
<ul><li><p><code>aov_fstat</code> (<code><a href="https://filtro.tidymodels.org/reference/score_aov_pval.html" class="external-link">documentation</a></code>)</p></li>
<li><p><code>aov_pval</code> (<code><a href="https://filtro.tidymodels.org/reference/score_aov_pval.html" class="external-link">documentation</a></code>)</p></li>
<li><p><code>cor_pearson</code> (<code><a href="https://filtro.tidymodels.org/reference/score_cor_pearson.html" class="external-link">documentation</a></code>)</p></li>
<li><p><code>cor_spearman</code> (<code><a href="https://filtro.tidymodels.org/reference/score_cor_pearson.html" class="external-link">documentation</a></code>)</p></li>
<li><p><code>gain_ratio</code> (<code><a href="https://filtro.tidymodels.org/reference/score_info_gain.html" class="external-link">documentation</a></code>)</p></li>
<li><p><code>imp_rf</code> (<code><a href="https://filtro.tidymodels.org/reference/score_imp_rf.html" class="external-link">documentation</a></code>)</p></li>
<li><p><code>imp_rf_conditional</code> (<code><a href="https://filtro.tidymodels.org/reference/score_imp_rf.html" class="external-link">documentation</a></code>)</p></li>
<li><p><code>imp_rf_oblique</code> (<code><a href="https://filtro.tidymodels.org/reference/score_imp_rf.html" class="external-link">documentation</a></code>)</p></li>
<li><p><code>info_gain</code> (<code><a href="https://filtro.tidymodels.org/reference/score_info_gain.html" class="external-link">documentation</a></code>)</p></li>
<li><p><code>roc_auc</code> (<code><a href="https://filtro.tidymodels.org/reference/score_roc_auc.html" class="external-link">documentation</a></code>)</p></li>
<li><p><code>sym_uncert</code> (<code><a href="https://filtro.tidymodels.org/reference/score_info_gain.html" class="external-link">documentation</a></code>)</p></li>
<li><p><code>xtab_pval_chisq</code> (<code><a href="https://filtro.tidymodels.org/reference/score_xtab_pval_chisq.html" class="external-link">documentation</a></code>)</p></li>
<li><p><code>xtab_pval_fisher</code> (<code><a href="https://filtro.tidymodels.org/reference/score_xtab_pval_chisq.html" class="external-link">documentation</a></code>)</p></li>
</ul><p>Some important notes:</p><ul><li><p>Scores that are p-values are automatically transformed by <span class="pkg">filtro</span> to
be in the format <code>-log10(pvalue)</code> so that a p-value of 0.1 is converted to
1.0. For these, use the <code><a href="https://desirability2.tidymodels.org/reference/aliases.html" class="external-link">maximize()</a></code> goal.</p></li>
<li><p>Other scores are also transformed in the data. For example, the correlation
scores given to the recipe step are in absolute value format. See the
<span class="pkg">filtro</span> documentation for each score.</p></li>
<li><p>You can use some in-line functions using base R functions. For example,
<code>maximize(max(score_cor_spearman))</code>.</p></li>
<li><p>If a predictor cannot be computed for all scores, it is given a "fallback
value" that will prevent it from being excluded for this reason.</p></li>
</ul><p>This step can potentially remove columns from the data set. This may cause
issues for subsequent steps in your recipe if the missing columns are
specifically referenced by name. To avoid this, see the advice in the <em>Tips
for saving recipes and filtering columns</em> section of <a href="https://recipes.tidymodels.org/reference/selections.html" class="external-link">recipes::selections</a>.</p>
</div>

<div class="section">
<h3 id="case-weights">Case Weights<a class="anchor" aria-label="anchor" href="#case-weights"></a></h3>


<p>Case weights can be used by some scoring functions. To learn more, load the
<span class="pkg">filtro</span> package and check the <code>case_weights</code> property of the score object
(see Examples below). For a recipe, use one of the tidymodels case weight
functions such as <code><a href="https://hardhat.tidymodels.org/reference/importance_weights.html" class="external-link">hardhat::importance_weights()</a></code> or
<a href="https://hardhat.tidymodels.org/reference/frequency_weights.html" class="external-link">hardhat::frequency_weights</a>, to assign the correct data type to the vector of case
weights. A recipe will then interpret that class to be a case weight (and no
other role). A full example is below.</p>
</div>

<div class="section">
<h3 id="tidy-method">Tidy method<a class="anchor" aria-label="anchor" href="#tidy-method"></a></h3>


<p>For a trained recipe, the <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> method will return a tibble with columns
<code>terms</code> (the predictor names), <code>id</code>, and columns for the estimated scores.
The score columns are the raw values, before being filled with "safe values"
or transformed.</p>
<p>There is an additional local column called <code>removed</code> that notes whether the
predictor failed the filter and was removed after this step is executed.</p>
</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/recipes" class="external-link">recipes</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">step_predictor_retain</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_predictors</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    score <span class="op">=</span> <span class="va">cor_pearson</span> <span class="op">&gt;=</span> <span class="fl">0.75</span> <span class="op">|</span> <span class="va">cor_spearman</span> <span class="op">&gt;=</span> <span class="fl">0.75</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">prepped</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep</a></span><span class="op">(</span><span class="va">rec</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://recipes.tidymodels.org/reference/bake.html" class="external-link">bake</a></span><span class="op">(</span><span class="va">prepped</span>, <span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 32 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      cyl  disp    hp    wt   mpg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>     6  160    110  2.62  21  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>     6  160    110  2.88  21  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>     4  108     93  2.32  22.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>     6  258    110  3.22  21.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>     8  360    175  3.44  18.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>     6  225    105  3.46  18.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>     8  360    245  3.57  14.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>     4  147.    62  3.19  24.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>     4  141.    95  3.15  22.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>     6  168.   123  3.44  19.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 22 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">prepped</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 10 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    terms removed cor_pearson cor_spearman id                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> cyl   FALSE        -<span style="color: #BB0000;">0.852</span>       -<span style="color: #BB0000;">0.911</span> predictor_retain_NTIFr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> disp  FALSE        -<span style="color: #BB0000;">0.848</span>       -<span style="color: #BB0000;">0.909</span> predictor_retain_NTIFr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> hp    FALSE        -<span style="color: #BB0000;">0.776</span>       -<span style="color: #BB0000;">0.895</span> predictor_retain_NTIFr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> drat  TRUE          0.681        0.651 predictor_retain_NTIFr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> wt    FALSE        -<span style="color: #BB0000;">0.868</span>       -<span style="color: #BB0000;">0.886</span> predictor_retain_NTIFr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> qsec  TRUE          0.419        0.467 predictor_retain_NTIFr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> vs    TRUE          0.664        0.707 predictor_retain_NTIFr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> am    TRUE          0.600        0.562 predictor_retain_NTIFr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> gear  TRUE          0.480        0.543 predictor_retain_NTIFr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> carb  TRUE         -<span style="color: #BB0000;">0.551</span>       -<span style="color: #BB0000;">0.657</span> predictor_retain_NTIFr</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/topepo" class="external-link">Max Kuhn</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

  </div></footer></body></html>

